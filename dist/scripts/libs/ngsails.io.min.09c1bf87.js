!function(e,t){"use strict";function n(){var e=/^\s*(\[|\{[^\{])/,n=/[\}\]]\s*$/,r=/^\)\]\}',?\n/,o={"Content-Type":"application/json;charset=utf-8"},c=this.defaults={transformResponse:[function(o){return t.isString(o)&&(o=o.replace(r,""),e.test(o)&&n.test(o)&&(o=x(o))),o}],transformRequest:[function(e){return!$(e)||C(e)||S(e)?e:O(e)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:t.copy(o),put:t.copy(o),patch:t.copy(o)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},l=this.interceptors=[],d=this.responseInterceptors=[];this.$get=["$sailsSocketBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(e,n,r,o,y,_){function C(e){function n(e){var n=t.extend({},e,{data:s(e.data,e.headers,o.transformResponse)});return i(e.status)?n:y.reject(n)}function r(e){function n(e){var t;p(e,function(n,r){w(n)&&(t=n(),null!=t?e[r]=t:delete e[r])})}var r,o,s,i=c.headers,a=t.extend({},e.headers);i=t.extend({},i.common,i[N(e.method)]),n(i),n(a);e:for(r in i){o=N(r);for(s in a)if(N(s)===o)continue e;a[r]=i[r]}return a}var o={method:"get",transformRequest:c.transformRequest,transformResponse:c.transformResponse},a=r(e);t.extend(o,e),o.headers=a,o.method=A(o.method);var l=f(o.url)?j(o.xsrfCookieName||c.xsrfCookieName):void 0;l&&(a[o.xsrfHeaderName||c.xsrfHeaderName]=l);var d=function(e){a=e.headers;var t=s(e.data,u(a),e.transformRequest);return g(e.data)&&p(a,function(e,t){"content-type"===N(t)&&delete a[t]}),g(e.withCredentials)&&!g(c.withCredentials)&&(e.withCredentials=c.withCredentials),E(e,t,a).then(n,n)},h=[d,void 0],m=y.when(o);for(p(U,function(e){(e.request||e.requestError)&&h.unshift(e.request,e.requestError),(e.response||e.responseError)&&h.push(e.response,e.responseError)});h.length;){var v=h.shift(),$=h.shift();m=m.then(v,$)}return m.success=function(e){return m.then(function(t){e(t.data,t.status,t.headers,o)}),m},m.error=function(e){return m.then(null,function(t){e(t.data,t.status,t.headers,o)}),m},m}function S(){t.forEach(arguments,function(e){C[e]=function(n,r){return C(t.extend(r||{},{method:e,url:n}))}})}function b(){t.forEach(arguments,function(e){C[e]=function(n,r,o){return C(t.extend(o||{},{method:e,url:n,data:r}))}})}function E(n,r,s){function f(e,t,n,r){d&&(i(e)?d.put(k,[e,t,a(n),r]):d.remove(k)),l(t,e,n,r),o.$$phase||o.$apply()}function l(e,t,r,o){t=Math.max(t,0),(i(t)?m.resolve:m.reject)({data:e,status:t,headers:u(r),config:n,statusText:o})}function p(){var e=R(C.pendingRequests,n);-1!==e&&C.pendingRequests.splice(e,1)}var d,h,m=y.defer(),g=m.promise,k=x(n.url,n.params);if(C.pendingRequests.push(n),g.then(p,p),(n.cache||c.cache)&&n.cache!==!1&&"GET"==n.method&&(d=$(n.cache)?n.cache:$(c.cache)?c.cache:I),d)if(h=d.get(k),v(h)){if(h.then)return h.then(p,p),h;q(h)?l(h[1],h[0],t.copy(h[2]),h[3]):l(h,200,{},"OK")}else d.put(k,g);return t.isUndefined(h)&&e(n.method,k,r,f,s,n.timeout,n.withCredentials,n.responseType),g}function x(e,n){if(!n)return e;var r=[];return h(n,function(e,n){null===e||g(e)||(q(e)||(e=[e]),t.forEach(e,function(e){$(e)&&(e=k(e)?e.toIsoString():O(e)),r.push(m(n)+"="+m(e))}))}),r.length>0&&(e+=(-1==e.indexOf("?")?"?":"&")+r.join("&")),e}function j(e){return e?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null}var I=r("$sailsSocket"),U=[];return t.forEach(l,function(e){U.unshift(t.isString(e)?_.get(e):_.invoke(e))}),t.forEach(d,function(e,n){var r=t.isString(e)?_.get(e):_.invoke(e);U.splice(n,0,{response:function(e){return r(y.when(e))},responseError:function(e){return r(y.reject(e))}})}),C.pendingRequests=[],S("get","delete","head"),C.subscribe=e.subscribe,b("post","put"),C.defaults=c,C}]}function r(e,n,r,o,s){function i(t,r,o,s,i){function a(e,t){s(t.statusCode,e)}r=r||e.url(),n.io.socket.request({method:t.toLowerCase(),url:r,data:x(o),headers:i},a)}if(!n.io)throw new Error("socket.io client not found");if(!n.io.sails)throw new Error("sails.io client not found");n.io.socket||console.warn("no connected socket...");var a=function(e,n){return n?function(){var t=arguments;s(function(){n.apply(e,t)},0)}:t.noop};return i.subscribe=function(e,r){var o=a(n.io.socket,r);return n.io.socket.on(e,o),t.bind(n.io.socket,n.io.socket.removeListener,e,o)},i}function o(){this.$get=["$browser","$window","$injector","$q","$timeout",function(e,t,n,o,s){return r(e,t,n,o,s)}]}function s(e,t,n){return w(n)?n(e,t):(p(n,function(n){e=n(e,t)}),e)}function i(e){return e>=200&&300>e}function a(e){var t,n,r,o={};return e?(p(e.split("\n"),function(e){r=e.indexOf(":"),t=N(trim(e.substr(0,r))),n=trim(e.substr(r+1)),t&&(o[t]?o[t]+=", "+n:o[t]=n)}),o):o}function u(e){var t=$(e)?e:void 0;return function(n){return t||(t=a(e)),n?t[N(n)]||null:t}}function c(e){var t=e;return"undefined"!=typeof msie&&(j.setAttribute("href",t),t=j.href),j.setAttribute("href",t),{href:j.href,protocol:j.protocol?j.protocol.replace(/:$/,""):"",host:j.host,search:j.search?j.search.replace(/^\?/,""):"",hash:j.hash?j.hash.replace(/^#/,""):"",hostname:j.hostname,port:j.port,pathname:"/"===j.pathname.charAt(0)?j.pathname:"/"+j.pathname}}function f(e){var t=y(e)?c(e):e;return t.protocol===I.protocol&&t.host===I.host}function l(e,t){var n=t;return"string"==typeof e&&"$"===e.charAt(0)?n=void 0:E(t)?n="$WINDOW":t&&document===t?n="$DOCUMENT":_(t)&&(n="$SCOPE"),n}function p(e,t,n){var r;if(e)if(w(e))for(r in e)"prototype"==r||"length"==r||"name"==r||e.hasOwnProperty&&!e.hasOwnProperty(r)||t.call(n,e[r],r);else if(e.forEach&&e.forEach!==p)e.forEach(t,n);else if(b(e))for(r=0;r<e.length;r++)t.call(n,e[r],r);else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r);return e}function d(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t.sort()}function h(e,t,n){for(var r=d(e),o=0;o<r.length;o++)t.call(n,e[r[o]],r[o]);return r}function m(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function g(e){return"undefined"==typeof e}function v(e){return"undefined"!=typeof e}function $(e){return null!=e&&"object"==typeof e}function y(e){return"string"==typeof e}function k(e){return"[object Date]"==={}.toString.call(e)}function w(e){return"function"==typeof e}function _(e){return e&&e.$evalAsync&&e.$watch}function C(e){return"[object File]"==={}.toString.call(e)}function S(e){return"[object Blob]"==={}.toString.call(e)}function q(e){return"[object Array]"==={}.toString.call(e)}function b(e){if(null==e||E(e))return!1;var t=e.length;return 1===e.nodeType&&t?!0:y(e)||q(e)||0===t||"number"==typeof t&&t>0&&t-1 in e}function E(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function O(e,t){return"undefined"==typeof e?void 0:JSON.stringify(e,l,t?"  ":null)}function x(e){return y(e)?JSON.parse(e):e}function R(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}t.module("angularSails.io",[]).constant("$$sailsConnectionMetaData",{version:"__sails_io_sdk_version",platform:"__sails_io_sdk_platform",language:"__sails_io_sdk_language"}).constant("$$sailsSDKParams",{version:"0.11.0",platform:"undefined"==typeof module?"browser":"node",language:"javascript",flavor:"angular"}).factory("$$sailsSDKInfo",["$$sailsConnectionMetaData","$$sailsSDKParams",function(e,t){function n(){var n=e.version+"="+t.version+"&"+e.platform+"="+t.platform+"&"+e.language+"="+t.language;return n}return{getVersionString:n}}]).factory("SocketIo",["$window",function(e){if(!e.io)throw new Error("Socket IO Not Found!");return e.io}]).provider("$sailsSocket",function(){var e=!1,n={autoConnect:!0,environment:"development",baseUrl:"http://localhost:1337"},r=function(r,o,s,i){function a(){var e={};this.socket={connected:!1},this.on=function(t,n){return e[t]=n,this},this.become=function(t){for(var n in e)t.on(n,e[n]);return t}}function u(e,n){t.isString(n)&&(n=t.fromJson(n)),this.data=n.body||{},this.headers=n.headers||{},this.status=n.statusCode||200,this.config=e}function c(t,n){var r=n.response;delete n.response;var o=n.method.toLowerCase();t.emit(o,n,l(t,function(t){e&&console.log(t);var o=new u(n,t);o.status>=400?r.reject(o):r.resolve(o)}))}var f=i.getVersionString(),l=function(e,n){return n?function(){var t=arguments;o(function(){n.apply(e,t)},0)}:t.noop},p=function(e){var r=this;r._requestQueue=[],r._socketOptions=t.extend({},n,e),r._socket=new a,r._socketOptions.autoConnect&&r.connect()};return p.prototype.connect=function(e,n){var o=r.defer(),i=this;n=n||{},e=e||i._socketOptions.baseUrl||void 0,"string"!=typeof n.query?n.query=f:n.query+="&"+f;var a=s.connect(e,n);return i._socket=i._socket.become(a),i._socket.on("connect",function(){t.forEach(i._requestQueue,function(e){c(i._socket,e)})}),i._socket.once("connect",o.resolve),i._socket.on("connecting",o.notify),i._socket.once("connect_failed",o.reject),i.connection=o,o.promise},p.prototype.isConnected=function(){return this.connection&&1===this.connection.promise.$$state.status},p.prototype.get=function(e,t){return this._request({method:"get",url:e,data:t})},p.prototype.post=function(e,t){return this._request({method:"post",url:e,data:t})},p.prototype.post=function(e,t){return this._request({method:"post",url:e,data:t})},p.prototype["delete"]=function(e,t){return this._request({method:"delete",url:e,data:t})},p.prototype._request=function(t){var n=r.defer(),o="Usage:\n socket."+(t.method||"request")+"( destinationURL, [dataToSend] )";if(t=t||{},t.data=t.data||{},t.headers=t.headers||{},t.url=t.url.replace(/^(.+)\/*\s*$/,"$1"),"string"!=typeof t.url)throw new Error("Invalid or missing URL!\n"+o);var s=this,i={method:t.method,data:t.data,url:t.url,headers:t.headers,response:n};return n.promise.success=function(t){return n.promise.then(function(n){e&&console.log(n),t(n.data,n.statusCode,n.headers,i)}),n.promise},n.promise.error=function(e){return n.promise.then(null,function(t){e(t.data,t.statusCode,t.headers,i)}),n.promise},s._socket&&s.isConnected()?c(s._socket,i):s._requestQueue.push(i),n.promise},p.prototype.on=function(e,t){var n=this;n._socket.on(e,l(n._socket,t))},function(e){var t=new p(e);return t}};return{$get:["$q","$timeout","SocketIo","$$sailsSDKInfo",r]}}),t.module("sails.io",[]).provider("$sailsSocket",n).provider("$sailsSocketBackend",o);var j=document.createElement("a"),I=c(e.location.href,!0),N=function(e){return y(e)?e.toLowerCase():e},A=(Object.prototype.hasOwnProperty,function(e){return y(e)?e.toUpperCase():e}),U=function(e){return y(e)?e.replace(/[A-Z]/g,function(e){return String.fromCharCode(32|e.charCodeAt(0))}):e},D=function(e){return y(e)?e.replace(/[a-z]/g,function(e){return String.fromCharCode(-33&e.charCodeAt(0))}):e};"i"!=="I".toLowerCase()&&(N=U,A=D)}(window,angular);