"use strict";angular.module("sauvetapp",["ui.router","sails.io","ngMap"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$sailsSocketProvider","$httpProvider",function(a,b,c,d,e){e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"],e.interceptors.push("AuthInterceptor"),d.interceptors.push("AuthInterceptor"),b.otherwise("/home"),a.state("app",{url:"/app",templateUrl:"/views/app.html"}).state("home",{url:"/home",controller:"MainCtrl",templateUrl:"/views/home/home.html"}).state("app.helpme",{url:"/helpme",controller:"MainCtrl",templateUrl:"/views/home/helpme.html"}).state("app.who",{url:"/who",templateUrl:"/views/home/who.html"}).state("app.map",{url:"/map",templateUrl:"/views/home/map.html"}).state("app.itinary",{resolve:{center:["$stateParams","$sailsSocket",function(a,b){return b.get("/center/"+a.id).then(function(a){return a.data},function(a){console.log(a)})}]},url:"/itinary/:id",controller:"MapCtrl",templateUrl:"/views/home/itinary.html"}).state("app.profile",{url:"/profile",templateUrl:"/views/home/profile.html"}).state("admin",{url:"/admin",templateUrl:"/views/admin.html"}).state("admin.home",{url:"/home",templateUrl:"/views/admin/home.html",controller:"AdminCtrl"}).state("admin.strategies",{url:"/strategies",controller:"StrategiesCtrl",templateUrl:"/views/admin/strategies.html"}).state("admin.infos",{url:"/infos",controller:"InfosCtrl",templateUrl:"/views/admin/infos.html"})}]),angular.module("sauvetapp").factory("Storage",function(){return{get:function(a){return localStorage.getItem(a)},set:function(a,b){return localStorage.setItem(a,b)},unset:function(a){return localStorage.removeItem(a)}}}),angular.module("sauvetapp").factory("AuthInterceptor",["$q","$injector","Storage",function(a,b,c){return{request:function(a){if(-1==a.url.indexOf("api.giphy.com")&&-1==a.url.indexOf("facebook.com")&&-1==a.url.indexOf("icecomm")&&-1==a.url.indexOf("amazonaws.com")&&-1==a.url.indexOf("google")){var b;c.get("token")&&(b=JSON.parse(c.get("token")).hash),b&&(a.data||(a.data={}),a.headers.Authorization="Bearer "+b)}else delete a.headers.Authorization;return a},responseError:function(d){return console.log("GOT 401 OR 403"),console.log(d),401!==d.status&&403!==d.status||!(d.config.url.indexOf("scalingo")>-1||d.config.url.indexOf("localhost")>-1)||(c.unset("token"),b.get("$state").go("login")),a.reject(d)}}}]),angular.module("sauvetapp").controller("MainCtrl",["$scope","$sailsSocket",function(a,b){function c(a){d=a.coords.latitude,e=a.coords.longitude}var d,e;navigator.geolocation&&navigator.geolocation.getCurrentPosition(c),a.postPanic=function(){console.log(e),console.log("JEEEJ"),b.post("/alert",{latitude:d,longitude:e,saved:!1}).then(function(a){console.log(a)},function(a){console.log(a)})},b.get("/strategy").then(function(a){console.log(a)},function(a){console.log(a)})}]),angular.module("sauvetapp").controller("AdminCtrl",["$scope","$sailsSocket","$timeout",function(a,b,c){b.get("/alert").then(function(b){console.log(b.data),a.markers=b.data},function(a){console.log(a)}),b.get("/center").then(function(b){console.log(b.data),a.centers=b.data},function(a){console.log(a)})}]),angular.module("sauvetapp").controller("StrategiesCtrl",["$scope","$sailsSocket",function(a,b){b.get("/strategy").then(function(b){a.strategies=b.data},function(a){console.log(a)}),a.save=function(a){b.put("/strategy/"+a.id,{instructions:a.instructions}).then(function(a){console.log("saved")},function(a){console.log(a)})}}]),angular.module("sauvetapp").controller("InfosCtrl",["$scope","$sailsSocket",function(a,b){}]),angular.module("sauvetapp").controller("MapCtrl",["$scope","$sailsSocket","$timeout","center",function(a,b,c,d){function e(b){a.lat=b.coords.latitude,a["long"]=b.coords.longitude}a.center=d,navigator.geolocation&&navigator.geolocation.getCurrentPosition(e),angular.element(document).ready(function(){c(function(){console.log("clicking"),angular.element(".gm-style").click()},3e3)})}]),angular.module("ngMap",[]),function(){var a,b=function(b,c,d,e,f,g){a=f;var h=this;h.mapOptions,h.mapEvents,h.ngMapDiv,h.addObject=function(a,b){if(h.map){h.map[a]=h.map[a]||{};var c=Object.keys(h.map[a]).length;h.map[a][b.id||c]=b,h.map instanceof google.maps.Map&&("infoWindows"!=a&&b.setMap&&b.setMap&&b.setMap(h.map),b.centered&&b.position&&h.map.setCenter(b.position),"markers"==a&&h.objectChanged("markers"),"customMarkers"==a&&h.objectChanged("customMarkers"))}},h.deleteObject=function(a,b){if(b.map){var c=b.map[a];for(var d in c)c[d]===b&&delete c[d];b.map&&b.setMap&&b.setMap(null),"markers"==a&&h.objectChanged("markers"),"customMarkers"==a&&h.objectChanged("customMarkers")}},h.observeAttrSetObj=function(b,c,d){if(c.noWatcher)return!1;for(var e=a.getAttrsToObserve(b),f=0;f<e.length;f++){var h=e[f];c.$observe(h,g.observeAndSet(h,d))}},h.zoomToIncludeMarkers=function(){var a=new google.maps.LatLngBounds;for(var b in h.map.markers)a.extend(h.map.markers[b].getPosition());for(var c in h.map.customMarkers)a.extend(h.map.customMarkers[c].getPosition());h.map.fitBounds(a)},h.objectChanged=function(a){"markers"!=a&&"customMarkers"!=a||"auto"!=h.map.zoomToIncludeMarkers||h.zoomToIncludeMarkers()},h.initializeMap=function(){var a=h.mapOptions,c=h.mapEvents,f=h.ngMapDiv,j=h.map;if(h.map=new google.maps.Map(f,{}),j)for(var k in j){var l=j[k];if("object"==typeof l)for(var m in l)h.addObject(k,l[m])}a.zoom=a.zoom||15;var n=a.center;if(!a.center||"string"==typeof n&&n.match(/\{\{.*\}\}/))a.center=new google.maps.LatLng(0,0);else if(!(n instanceof google.maps.LatLng)){var o=a.center;delete a.center,g.getGeoLocation(o,a.geoLocationOptions).then(function(c){h.map.setCenter(c);var d=a.geoCallback;d&&e(d)(b)},function(){a.geoFallbackCenter&&h.map.setCenter(a.geoFallbackCenter)})}h.map.setOptions(a);for(var p in c)google.maps.event.addListener(h.map,p,c[p]);h.observeAttrSetObj(i,d,h.map),h.singleInfoWindow=a.singleInfoWindow,google.maps.event.addListenerOnce(h.map,"idle",function(){g.addMap(h),a.zoomToIncludeMarkers&&h.zoomToIncludeMarkers(),b.map=h.map,b.$emit("mapInitialized",h.map),d.mapInitialized&&e(d.mapInitialized)(b,{map:h.map})})},b.google=google;var i=a.orgAttributes(c),j=a.filter(d),k=a.getOptions(j),l=a.getControlOptions(j),m=angular.extend(k,l),n=a.getEvents(b,j);h.mapOptions=m,h.mapEvents=n,h.ngMapDiv=g.getNgMapDiv(c[0]),c.append(h.ngMapDiv),k.lazyInit?(h.map={id:d.id},g.addMap(h)):h.initializeMap(),c.bind("$destroy",function(){g.deleteMap(h)})};b.$inject=["t","n","o","i","r","a"],b.$inject=["$scope","$element","$attrs","$parse","Attr2MapOptions","NgMap"],angular.module("ngMap").controller("__MapController",b)}(),function(){var a,b=function(b,d,e,f){f=f[0]||f[1];var g=a.orgAttributes(d),h=a.filter(e),i=a.getOptions(h),j=a.getEvents(b,h),k=c(i,j);f.addObject("bicyclingLayers",k),f.observeAttrSetObj(g,e,k),d.bind("$destroy",function(){f.deleteObject("bicyclingLayers",k)})},c=function(a,b){var c=new google.maps.BicyclingLayer(a);for(var d in b)google.maps.event.addListener(c,d,b[d]);return c},d=function(c){return a=c,{restrict:"E",require:["?^map","?^ngMap"],link:b}};d.$inject=["n"],d.$inject=["Attr2MapOptions"],angular.module("ngMap").directive("bicyclingLayer",d)}(),function(){var a,b,c,d=function(d,e,f,g){g=g[0]||g[1];var h=a.filter(f),i=a.getOptions(h),j=a.getEvents(d,h),k=e[0].parentElement.removeChild(e[0]);b(k.innerHTML.trim())(d);for(var l in j)google.maps.event.addDomListener(k,l,j[l]);g.addObject("customControls",k),c.getMap().then(function(a){var b=i.position;a.controls[google.maps.ControlPosition[b]].push(k)})},e=function(e,f,g){return a=e,b=f,c=g,{restrict:"E",require:["?^map","?^ngMap"],link:d}};e.$inject=["i","r","a"],e.$inject=["Attr2MapOptions","$compile","NgMap"],angular.module("ngMap").directive("customControl",e)}(),function(){var a,b,c,d,e=function(a){a=a||{},this.el=document.createElement("div"),this.el.style.display="inline-block",this.visible=!0;for(var b in a)this[b]=a[b]},f=function(){e.prototype=new google.maps.OverlayView,e.prototype.setContent=function(a,b){this.el.innerHTML=a,this.el.style.position="absolute",b&&c(angular.element(this.el).contents())(b)},e.prototype.getDraggable=function(){return this.draggable},e.prototype.setDraggable=function(a){this.draggable=a},e.prototype.getPosition=function(){return this.position},e.prototype.setPosition=function(a){if(a&&(this.position=a),this.getProjection()&&"function"==typeof this.position.lng){var b=this.getProjection().fromLatLngToDivPixel(this.position),c=Math.round(b.x-this.el.offsetWidth/2),d=Math.round(b.y-this.el.offsetHeight-10);this.el.style.left=c+"px",this.el.style.top=d+"px"}},e.prototype.setZIndex=function(a){a&&(this.zIndex=a),this.el.style.zIndex=this.zIndex},e.prototype.setVisible=function(a){this.el.style.display=a?"inline-block":"none",this.visible=a},e.prototype.addClass=function(a){var b=this.el.className.trim().split(" ");-1==b.indexOf(a)&&b.push(a),this.el.className=b.join(" ")},e.prototype.removeClass=function(a){var b=this.el.className.split(" "),c=b.indexOf(a);c>-1&&b.splice(c,1),this.el.className=b.join(" ")},e.prototype.onAdd=function(){this.getPanes().overlayMouseTarget.appendChild(this.el)},e.prototype.draw=function(){this.setPosition(),this.setZIndex(this.zIndex),this.setVisible(this.visible)},e.prototype.onRemove=function(){this.el.parentNode.removeChild(this.el)}},g=function(c,f){return function(g,h,i,j){j=j[0]||j[1];var k=a.orgAttributes(h),l=a.filter(i),m=a.getOptions(l,g),n=a.getEvents(g,l),o=h[0].parentElement.removeChild(h[0]),p=new e(m);b(function(){g.$watch("["+f.join(",")+"]",function(){p.setContent(c,g)}),p.setContent(o.innerHTML,g);var a=o.firstElementChild.className;p.addClass("custom-marker"),p.addClass(a),m.position instanceof google.maps.LatLng||d.getGeoLocation(m.position).then(function(a){p.setPosition(a)})});for(var q in n)google.maps.event.addDomListener(p.el,q,n[q]);j.addObject("customMarkers",p),j.observeAttrSetObj(k,i,p),h.bind("$destroy",function(){j.deleteObject("customMarkers",p)})}},h=function(e,h,i,j){return a=i,b=e,c=h,d=j,{restrict:"E",require:["?^map","?^ngMap"],compile:function(a){f(),a[0].style.display="none";var b=a.html(),c=b.match(/{{([^}]+)}}/g),d=[];return(c||[]).forEach(function(a){var b=a.replace("{{","").replace("}}","");-1==a.indexOf("::")&&-1==a.indexOf("this.")&&-1==d.indexOf(b)&&d.push(a.replace("{{","").replace("}}",""))}),g(b,d)}}};h.$inject=["i","s","p","c"],h.$inject=["$timeout","$compile","Attr2MapOptions","NgMap"],angular.module("ngMap").directive("customMarker",h)}(),function(){var a,b,c,d=function(a,b){a.panel&&(a.panel=document.getElementById(a.panel)||document.querySelector(a.panel));var c=new google.maps.DirectionsRenderer(a);for(var d in b)google.maps.event.addListener(c,d,b[d]);return c},e=function(a,d){var e=new google.maps.DirectionsService,f=d;f.travelMode=f.travelMode||"DRIVING";var g=["origin","destination","travelMode","transitOptions","unitSystem","durationInTraffic","waypoints","optimizeWaypoints","provideRouteAlternatives","avoidHighways","avoidTolls","region"];for(var h in f)-1===g.indexOf(h)&&delete f[h];f.waypoints&&("[]"==f.waypoints||""===f.waypoints)&&delete f.waypoints;var i=function(c){e.route(c,function(c,d){d==google.maps.DirectionsStatus.OK&&b(function(){a.setDirections(c)})})};f.origin&&f.destination&&("current-location"==f.origin?c.getCurrentPosition().then(function(a){f.origin=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),i(f)}):"current-location"==f.destination?c.getCurrentPosition().then(function(a){f.destination=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),i(f)}):i(f))},f=function(f,g,h,i){var j=f;a=i,b=g,c=h;var k=function(c,f,g,h){h=h[0]||h[1];var i=j.orgAttributes(f),k=j.filter(g),l=j.getOptions(k),m=j.getEvents(c,k),n=j.getAttrsToObserve(i),o=d(l,m);h.addObject("directionsRenderers",o),n.forEach(function(a){!function(a){g.$observe(a,function(c){if("panel"==a)b(function(){var a=document.getElementById(c)||document.querySelector(c);a&&o.setPanel(a)});else if(l[a]!==c){var d=j.toOptionValue(c,{key:a});l[a]=d,e(o,l)}})}(a)}),a.getMap().then(function(){e(o,l)}),f.bind("$destroy",function(){h.deleteObject("directionsRenderers",o)})};return{restrict:"E",require:["?^map","?^ngMap"],link:k}};f.$inject=["r","a","s","p"],f.$inject=["Attr2MapOptions","$timeout","NavigatorGeolocation","NgMap"],angular.module("ngMap").directive("directions",f)}(),function(){angular.module("ngMap").directive("drawingManager",["Attr2MapOptions",function(a){var b=a;return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,c,d,e){e=e[0]||e[1];var f=b.filter(d),g=b.getOptions(f),h=b.getControlOptions(f),i=b.getEvents(a,f),j=new google.maps.drawing.DrawingManager({drawingMode:g.drawingmode,drawingControl:g.drawingcontrol,drawingControlOptions:h.drawingControlOptions,circleOptions:g.circleoptions,markerOptions:g.markeroptions,polygonOptions:g.polygonoptions,polylineOptions:g.polylineoptions,rectangleOptions:g.rectangleoptions});for(var k in i)google.maps.event.addListener(j,k,i[k]);e.addObject("mapDrawingManager",j)}}}])}(),function(){angular.module("ngMap").directive("dynamicMapsEngineLayer",["Attr2MapOptions",function(a){var b=a,c=function(a,b){var c=new google.maps.visualization.DynamicMapsEngineLayer(a);for(var d in b)google.maps.event.addListener(c,d,b[d]);return c};return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,d,e,f){f=f[0]||f[1];var g=b.filter(e),h=b.getOptions(g),i=b.getEvents(a,g,i),j=c(h,i);f.addObject("mapsEngineLayers",j)}}}])}(),function(){angular.module("ngMap").directive("fusionTablesLayer",["Attr2MapOptions",function(a){var b=a,c=function(a,b){var c=new google.maps.FusionTablesLayer(a);for(var d in b)google.maps.event.addListener(c,d,b[d]);return c};return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,d,e,f){f=f[0]||f[1];var g=b.filter(e),h=b.getOptions(g),i=b.getEvents(a,g,i),j=c(h,i);f.addObject("fusionTablesLayers",j)}}}])}(),function(){angular.module("ngMap").directive("heatmapLayer",["Attr2MapOptions","$window",function(a,b){var c=a;return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,d,e,f){f=f[0]||f[1];var g=c.filter(e),h=c.getOptions(g);if(h.data=b[e.data]||a[e.data],!(h.data instanceof Array))throw"invalid heatmap data";h.data=new google.maps.MVCArray(h.data);var i=new google.maps.visualization.HeatmapLayer(h);c.getEvents(a,g),f.addObject("heatmapLayers",i)}}}])}(),function(){var a=function(a,b,c,d,e){var f=a,g=function(a,d,e){var f;!a.position||a.position instanceof google.maps.LatLng||delete a.position,f=new google.maps.InfoWindow(a),Object.keys(d).length>0;for(var g in d)g&&google.maps.event.addListener(f,g,d[g]);var h=e.html().trim();if(1!=angular.element(h).length)throw"info-window working as a template must have a container";return f.__template=h.replace(/\s?ng-non-bindable[='"]+/,""),f.__open=function(a,d,e){c(function(){e&&(d.anchor=e);var c=b(f.__template)(d);f.setContent(c[0]),d.$apply(),e&&e.getPosition?f.open(a,e):e&&e instanceof google.maps.LatLng?(f.open(a),f.setPosition(e)):f.open(a)})},f},h=function(a,b,c,h){h=h[0]||h[1],b.css("display","none");var i,j=f.orgAttributes(b),k=f.filter(c),l=f.getOptions(k),m=f.getEvents(a,k);!l.position||l.position instanceof google.maps.LatLng||(i=l.position);var n=g(l,m,b);i&&e.getGeoLocation(i).then(function(b){n.setPosition(b),n.__open(h.map,a,b);var e=c.geoCallback;e&&d(e)(a)}),h.addObject("infoWindows",n),h.observeAttrSetObj(j,c,n),h.map.showInfoWindow=h.map.showInfoWindow||function(b,c,d){var e="string"==typeof b?b:c,f="string"==typeof b?c:d;"string"==typeof f&&(f=h.map.markers[f]);var g=h.map.infoWindows[e],i=f?f:this.getPosition?this:null;g.__open(h.map,a,i),h.singleInfoWindow&&(h.lastInfoWindow&&a.hideInfoWindow(h.lastInfoWindow),h.lastInfoWindow=e)},h.map.hideInfoWindow=h.map.hideInfoWindow||function(a,b){var c="string"==typeof a?a:b,d=h.map.infoWindows[c];d.close()},a.showInfoWindow=h.map.showInfoWindow,a.hideInfoWindow=h.map.hideInfoWindow,e.getMap().then(function(b){if(n.visible&&n.__open(b,a),n.visibleOnMarker){var c=n.visibleOnMarker;n.__open(b,a,b.markers[c])}})};return{restrict:"E",require:["?^map","?^ngMap"],link:h}};a.$inject=["e","t","n","o","i"],a.$inject=["Attr2MapOptions","$compile","$timeout","$parse","NgMap"],angular.module("ngMap").directive("infoWindow",a)}(),function(){angular.module("ngMap").directive("kmlLayer",["Attr2MapOptions",function(a){var b=a,c=function(a,b){var c=new google.maps.KmlLayer(a);for(var d in b)google.maps.event.addListener(c,d,b[d]);return c};return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,d,e,f){f=f[0]||f[1];var g=b.orgAttributes(d),h=b.filter(e),i=b.getOptions(h),j=b.getEvents(a,h),k=c(i,j);f.addObject("kmlLayers",k),f.observeAttrSetObj(g,e,k),d.bind("$destroy",function(){f.deleteObject("kmlLayers",k)})}}}])}(),function(){angular.module("ngMap").directive("mapData",["Attr2MapOptions","NgMap",function(a,b){var c=a;return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,d,e){var f=c.filter(e),g=c.getOptions(f),h=c.getEvents(a,f,h);b.getMap().then(function(b){for(var c in g){var d=g[c];"function"==typeof a[d]?b.data[c](a[d]):b.data[c](d)}for(var e in h)b.data.addListener(e,h[e])})}}}])}(),function(){var a,b,c,d,e=function(c,e,f){var g=f.mapLazyLoadParams||f.mapLazyLoad;if(window.lazyLoadCallback=function(){a(function(){e.html(d),b(e.contents())(c)},100)},void 0===window.google||void 0===window.google.maps){var h=document.createElement("script");h.src=g+(g.indexOf("?")>-1?"&":"?")+"callback=lazyLoadCallback",document.body.appendChild(h)}else e.html(d),b(e.contents())(c)},f=function(a,b){return!b.mapLazyLoad&&void 0,d=a.html(),c=b.mapLazyLoad,document.querySelector('script[src="'+c+(c.indexOf("?")>-1?"&":"?")+'callback=lazyLoadCallback"]')?!1:(a.html(""),{pre:e})},g=function(c,d){return b=c,a=d,{compile:f}};g.$inject=["n","o"],g.$inject=["$compile","$timeout"],angular.module("ngMap").directive("mapLazyLoad",g)}(),function(){angular.module("ngMap").directive("mapType",["$parse","NgMap",function(a,b){return{restrict:"E",require:["?^map","?^ngMap"],link:function(c,d,e,f){f=f[0]||f[1];var g,h=e.name;if(!h)throw"invalid map-type name";if(g=a(e.object)(c),!g)throw"invalid map-type object";b.getMap().then(function(a){a.mapTypes.set(h,g)}),f.addObject("mapTypes",g)}}}])}(),function(){var a=function(){return{restrict:"AE",controller:"__MapController",conrollerAs:"ngmap"}};angular.module("ngMap").directive("map",[a]),angular.module("ngMap").directive("ngMap",[a])}(),function(){angular.module("ngMap").directive("mapsEngineLayer",["Attr2MapOptions",function(a){var b=a,c=function(a,b){var c=new google.maps.visualization.MapsEngineLayer(a);for(var d in b)google.maps.event.addListener(c,d,b[d]);return c};return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,d,e,f){f=f[0]||f[1];var g=b.filter(e),h=b.getOptions(g),i=b.getEvents(a,g,i),j=c(h,i);f.addObject("mapsEngineLayers",j)}}}])}(),function(){var a,b,c,d=function(a,b){var d;if(c.defaultOptions.marker)for(var e in c.defaultOptions.marker)"undefined"==typeof a[e]&&(a[e]=c.defaultOptions.marker[e]);a.position instanceof google.maps.LatLng||(a.position=new google.maps.LatLng(0,0)),d=new google.maps.Marker(a),Object.keys(b).length>0;for(var f in b)f&&google.maps.event.addListener(d,f,b[f]);return d},e=function(e,f,g,h){h=h[0]||h[1];var i,j=a.orgAttributes(f),k=a.filter(g),l=a.getOptions(k,e),m=a.getEvents(e,k);l.position instanceof google.maps.LatLng||(i=l.position);var n=d(l,m);h.addObject("markers",n),i&&c.getGeoLocation(i).then(function(a){n.setPosition(a),l.centered&&n.map.setCenter(a);var c=g.geoCallback;c&&b(c)(e)}),h.observeAttrSetObj(j,g,n),f.bind("$destroy",function(){h.deleteObject("markers",n)})},f=function(d,f,g){return a=d,b=f,c=g,{restrict:"E",require:["^?map","?^ngMap"],link:e}};f.$inject=["o","r","a"],f.$inject=["Attr2MapOptions","$parse","NgMap"],angular.module("ngMap").directive("marker",f)}(),function(){angular.module("ngMap").directive("overlayMapType",["NgMap",function(a){return{restrict:"E",require:["?^map","?^ngMap"],link:function(b,c,d,e){e=e[0]||e[1];var f=d.initMethod||"insertAt",g=b[d.object];a.getMap().then(function(a){if("insertAt"==f){var b=parseInt(d.index,10);a.overlayMapTypes.insertAt(b,g)}else"push"==f&&a.overlayMapTypes.push(g)}),e.addObject("overlayMapTypes",g)}}}])}(),function(){var a=function(a,b){var c=a,d=function(a,d,e,f){if("false"===e.placesAutoComplete)return!1;var g=c.filter(e),h=c.getOptions(g),i=c.getEvents(a,g),j=new google.maps.places.Autocomplete(d[0],h);for(var k in i)google.maps.event.addListener(j,k,i[k]);var l=function(){b(function(){f&&f.$setViewValue(d.val())},100)};google.maps.event.addListener(j,"place_changed",l),d[0].addEventListener("change",l),e.$observe("types",function(a){if(a){var b=c.toOptionValue(a,{key:"types"});j.setTypes(b)}})};return{restrict:"A",require:"?ngModel",link:d}};a.$inject=["e","t"],a.$inject=["Attr2MapOptions","$timeout"],angular.module("ngMap").directive("placesAutoComplete",a)}(),function(){var a=function(a,b){var c,d=a.name;switch(delete a.name,d){case"circle":a.center instanceof google.maps.LatLng||(a.center=new google.maps.LatLng(0,0)),c=new google.maps.Circle(a);break;case"polygon":c=new google.maps.Polygon(a);break;case"polyline":c=new google.maps.Polyline(a);break;case"rectangle":c=new google.maps.Rectangle(a);break;case"groundOverlay":case"image":var e=a.url,f={opacity:a.opacity,clickable:a.clickable,id:a.id};c=new google.maps.GroundOverlay(e,a.bounds,f)}for(var g in b)b[g]&&google.maps.event.addListener(c,g,b[g]);return c},b=function(b,c,d){var e=b,f=function(b,f,g,h){h=h[0]||h[1];var i,j,k=e.orgAttributes(f),l=e.filter(g),m=e.getOptions(l),n=e.getEvents(b,l);j=m.name,m.center instanceof google.maps.LatLng||(i=m.center);var o=a(m,n);h.addObject("shapes",o),i&&"circle"==j&&d.getGeoLocation(i).then(function(a){o.setCenter(a),o.centered&&o.map.setCenter(a);var d=g.geoCallback;d&&c(d)(b)}),h.observeAttrSetObj(k,g,o),f.bind("$destroy",function(){h.deleteObject("shapes",o)})};return{restrict:"E",require:["?^map","?^ngMap"],link:f}};b.$inject=["t","n","o"],b.$inject=["Attr2MapOptions","$parse","NgMap"],angular.module("ngMap").directive("shape",b)}(),function(){var a=function(a,b){var c=a,d=function(a,b,c){var d,e;b.container&&(e=document.getElementById(b.container),e=e||document.querySelector(b.container)),e?d=new google.maps.StreetViewPanorama(e,b):(d=a.getStreetView(),d.setOptions(b));for(var f in c)f&&google.maps.event.addListener(d,f,c[f]);return d},e=function(a,e,f){var g=c.filter(f),h=c.getOptions(g),i=c.getControlOptions(g),j=angular.extend(h,i),k=c.getEvents(a,g);b.getMap().then(function(a){var b=d(a,j,k);a.setStreetView(b),!b.getPosition()&&b.setPosition(a.getCenter()),google.maps.event.addListener(b,"position_changed",function(){b.getPosition()!==a.getCenter()&&a.setCenter(b.getPosition())});var c=google.maps.event.addListener(a,"center_changed",function(){b.setPosition(a.getCenter()),google.maps.event.removeListener(c)})})};return{restrict:"E",require:["?^map","?^ngMap"],link:e}};a.$inject=["e","t"],a.$inject=["Attr2MapOptions","NgMap"],angular.module("ngMap").directive("streetViewPanorama",a)}(),function(){angular.module("ngMap").directive("trafficLayer",["Attr2MapOptions",function(a){var b=a,c=function(a,b){var c=new google.maps.TrafficLayer(a);for(var d in b)google.maps.event.addListener(c,d,b[d]);return c};return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,d,e,f){f=f[0]||f[1];var g=b.orgAttributes(d),h=b.filter(e),i=b.getOptions(h),j=b.getEvents(a,h),k=c(i,j);f.addObject("trafficLayers",k),f.observeAttrSetObj(g,e,k),d.bind("$destroy",function(){f.deleteObject("trafficLayers",k)})}}}])}(),function(){angular.module("ngMap").directive("transitLayer",["Attr2MapOptions",function(a){var b=a,c=function(a,b){var c=new google.maps.TransitLayer(a);for(var d in b)google.maps.event.addListener(c,d,b[d]);return c};return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,d,e,f){f=f[0]||f[1];var g=b.orgAttributes(d),h=b.filter(e),i=b.getOptions(h),j=b.getEvents(a,h),k=c(i,j);f.addObject("transitLayers",k),f.observeAttrSetObj(g,e,k),d.bind("$destroy",function(){f.deleteObject("transitLayers",k)})}}}])}(),function(){var a=/([\:\-\_]+(.))/g,b=/^moz([A-Z])/,c=function(){return function(c){return c.replace(a,function(a,b,c,d){return d?c.toUpperCase():c}).replace(b,"Moz$1")}};angular.module("ngMap").filter("camelCase",c)}(),function(){var a=function(){return function(a){try{return JSON.parse(a),a}catch(b){return a.replace(/([\$\w]+)\s*:/g,function(a,b){return'"'+b+'":'}).replace(/'([^']+)'/g,function(a,b){return'"'+b+'"'})}}};angular.module("ngMap").filter("jsonize",a)}(),function(){var isoDateRE=/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):?(\d\d))?$/,Attr2MapOptions=function($parse,$timeout,$log,NavigatorGeolocation,GeoCoder,camelCaseFilter,jsonizeFilter){var orgAttributes=function(a){a.length>0&&(a=a[0]);for(var b={},c=0;c<a.attributes.length;c++){var d=a.attributes[c];b[d.name]=d.value}return b},getJSON=function(a){var b=/^[\+\-]?[0-9\.]+,[ ]*\ ?[\+\-]?[0-9\.]+$/;return a.match(b)&&(a="["+a+"]"),JSON.parse(jsonizeFilter(a))},getLatLng=function(a){var b=a;return a[0].constructor==Array?b=a.map(function(a){return new google.maps.LatLng(a[0],a[1])}):!isNaN(parseFloat(a[0]))&&isFinite(a[0])&&(b=new google.maps.LatLng(b[0],b[1])),b},toOptionValue=function(input,options){var output;try{output=getNumber(input)}catch(err){try{var output=getJSON(input);if(output instanceof Array)output=output[0].constructor==Object?output:getLatLng(output);else if(output===Object(output)){var newOptions=options;newOptions.doNotConverStringToNumber=!0,output=getOptions(output,newOptions)}}catch(err2){if(input.match(/^[A-Z][a-zA-Z0-9]+\(.*\)$/))try{var exp="new google.maps."+input;output=eval(exp)}catch(e){output=input}else if(input.match(/^([A-Z][a-zA-Z0-9]+)\.([A-Z]+)$/))try{var matches=input.match(/^([A-Z][a-zA-Z0-9]+)\.([A-Z]+)$/);output=google.maps[matches[1]][matches[2]]}catch(e){output=input}else if(input.match(/^[A-Z]+$/))try{var capitalizedKey=options.key.charAt(0).toUpperCase()+options.key.slice(1);options.key.match(/temperatureUnit|windSpeedUnit|labelColor/)?(capitalizedKey=capitalizedKey.replace(/s$/,""),output=google.maps.weather[capitalizedKey][input]):output=google.maps[capitalizedKey][input]}catch(e){output=input}else if(input.match(isoDateRE))try{output=new Date(input)}catch(e){output=input}else output=input}}if("bounds"==options.key&&output instanceof Array&&(output=new google.maps.LatLngBounds(output[0],output[1])),"icons"==options.key&&output instanceof Array)for(var i=0;i<output.length;i++){var el=output[i];el.icon.path.match(/^[A-Z_]+$/)&&(el.icon.path=google.maps.SymbolPath[el.icon.path])}if("icon"==options.key&&output instanceof Object){(""+output.path).match(/^[A-Z_]+$/)&&(output.path=google.maps.SymbolPath[output.path]);for(var key in output){var arr=output[key];"anchor"==key||"origin"==key?output[key]=new google.maps.Point(arr[0],arr[1]):("size"==key||"scaledSize"==key)&&(output[key]=new google.maps.Size(arr[0],arr[1]))}}return output},getAttrsToObserve=function(a){var b=[];if(!a.noWatcher)for(var c in a){var d=a[c];d&&d.match(/\{\{.*\}\}/)&&b.push(camelCaseFilter(c))}return b},filter=function(a){var b={};for(var c in a)c.match(/^\$/)||c.match(/^ng[A-Z]/)||(b[c]=a[c]);return b},getOptions=function(a,b){var c={};for(var d in a)if(a[d]||0===a[d]){if(d.match(/^on[A-Z]/))continue;if(d.match(/ControlOptions$/))continue;c[d]="string"!=typeof a[d]?a[d]:b&&b.doNotConverStringToNumber&&a[d].match(/^[0-9]+$/)?a[d]:toOptionValue(a[d],{key:d})}return c},getEvents=function(a,b){var c={},d=function(a){return"_"+a.toLowerCase()},e=function(b){var c=b.match(/([^\(]+)\(([^\)]*)\)/),d=c[1],e=c[2].replace(/event[ ,]*/,""),f=$parse("["+e+"]");return function(b){function c(a,b){return a[b]}var e=f(a),g=d.split(".").reduce(c,a);g&&g.apply(this,[b].concat(e)),$timeout(function(){a.$apply()})}};for(var f in b)if(b[f]){if(!f.match(/^on[A-Z]/))continue;var g=f.replace(/^on/,"");g=g.charAt(0).toLowerCase()+g.slice(1),g=g.replace(/([A-Z])/g,d);var h=b[f];c[g]=new e(h)}return c},getControlOptions=function(a){var b={};if("object"!=typeof a)return!1;for(var c in a)if(a[c]){if(!c.match(/(.*)ControlOptions$/))continue;var d=a[c],e=d.replace(/'/g,'"');e=e.replace(/([^"]+)|("[^"]+")/g,function(a,b,c){return b?b.replace(/([a-zA-Z0-9]+?):/g,'"$1":'):c});try{var f=JSON.parse(e);for(var g in f)if(f[g]){var h=f[g];if("string"==typeof h?h=h.toUpperCase():"mapTypeIds"===g&&(h=h.map(function(a){return a.match(/^[A-Z]+$/)?google.maps.MapTypeId[a.toUpperCase()]:a})),"style"===g){var i=c.charAt(0).toUpperCase()+c.slice(1),j=i.replace(/Options$/,"")+"Style";f[g]=google.maps[j][h]}else f[g]="position"===g?google.maps.ControlPosition[h]:h}b[c]=f}catch(k){}}return b};return{filter:filter,getOptions:getOptions,getEvents:getEvents,getControlOptions:getControlOptions,toOptionValue:toOptionValue,getAttrsToObserve:getAttrsToObserve,orgAttributes:orgAttributes}};Attr2MapOptions.$inject=["$parse","$timeout","$log","NavigatorGeolocation","GeoCoder","camelCaseFilter","jsonizeFilter"],Attr2MapOptions.$inject=["$parse","$timeout","$log","NavigatorGeolocation","GeoCoder","camelCaseFilter","jsonizeFilter"],angular.module("ngMap").service("Attr2MapOptions",Attr2MapOptions)}(),function(){var a,b=function(b){var c=a.defer(),d=new google.maps.Geocoder;return d.geocode(b,function(a,b){b==google.maps.GeocoderStatus.OK?c.resolve(a):c.reject(b)}),c.promise},c=function(c){return a=c,{geocode:b}};c.$inject=["n"],c.$inject=["$q"],angular.module("ngMap").service("GeoCoder",c)}(),function(){var a,b=function(b){var c=a.defer();return navigator.geolocation?(void 0===b?b={timeout:5e3}:void 0===b.timeout&&(b.timeout=5e3),navigator.geolocation.getCurrentPosition(function(a){c.resolve(a)},function(a){c.reject(a)},b)):c.reject("Browser Geolocation service failed."),c.promise},c=function(c){return a=c,{getCurrentPosition:b}};c.$inject=["n"],c.$inject=["$q"],angular.module("ngMap").service("NavigatorGeolocation",c)}(),function(){var a,b,c,d,e,f,g,h={},i=function(a){var b=h[a||0];b.map instanceof google.maps.Map||b.initializeMap()},j=function(b){function d(b){h[f]?e.resolve(h[f].map):b>g?e.reject("could not find map"):a.setTimeout(function(){d(b+100)},100)}b=b||{};var e=c.defer(),f=b.id||0,g=b.timeout||2e3;return d(0),e.promise},k=function(a){var b=Object.keys(h).length;h[a.map.id||b]=a},l=function(a){var b=Object.keys(h).length-1;delete h[a.map.id||b]},m=function(c,d){var e;return c.currentStyle?e=c.currentStyle[d]:a.getComputedStyle&&(e=b.defaultView.getComputedStyle(c,null).getPropertyValue(d)),e},n=function(a){var c=b.createElement("div"),d=a.getAttribute("default-style");return c.style.width="100%",c.style.height="100%","true"==d?a.style.display="block":("block"!=m(a,"display")&&(a.style.display="block"),m(a,"height").match(/^(0|auto)/)&&(a.style.height="500px")),c.addEventListener("dragstart",function(a){return a.preventDefault(),!1}),c},o=function(a,b){var e=c.defer();return!a||a.match(/^current/i)?d.getCurrentPosition(b).then(function(a){var b=a.coords.latitude,c=a.coords.longitude,d=new google.maps.LatLng(b,c);e.resolve(d)},function(a){e.reject(a)}):f.geocode({address:a}).then(function(a){e.resolve(a[0].geometry.location)},function(a){e.reject(a)}),e.promise},p=function(a,b){return function(c){if(c){var d=g("set-"+a),f=e.toOptionValue(c,{key:a});b[d]&&(a.match(/center|position/)&&"string"==typeof f?o(f).then(function(a){b[d](a)}):b[d](f))}}};angular.module("ngMap").provider("NgMap",function(){var h={};this.setDefaultOptions=function(a){h=a};var q=function(q,r,s,t,u,v,w){return a=q,b=r[0],c=s,d=t,e=u,f=v,g=w,{defaultOptions:h,addMap:k,deleteMap:l,getMap:j,initMap:i,getStyle:m,getNgMapDiv:n,getGeoLocation:o,observeAndSet:p}};q.$inject=["v","y","h","M","O","b","w"],q.$inject=["$window","$document","$q","NavigatorGeolocation","Attr2MapOptions","GeoCoder","camelCaseFilter"],this.$get=q})}(),function(){var a,b=function(b,c){c=c||b.getCenter();var d=a.defer(),e=new google.maps.StreetViewService;
return e.getPanoramaByLocation(c||b.getCenter,100,function(a,b){b===google.maps.StreetViewStatus.OK?d.resolve(a.location.pano):d.resolve(!1)}),d.promise},c=function(a,b){var c=new google.maps.StreetViewPanorama(a.getDiv(),{enableCloseButton:!0});c.setPano(b)},d=function(d){return a=d,{getPanorama:b,setPanorama:c}};d.$inject=["o"],d.$inject=["$q"],angular.module("ngMap").service("StreetView",d)}();